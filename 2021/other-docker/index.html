<!DOCTYPE html>
<html lang="en-us">
  <head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp"/>
  <meta name="author" content="Jiang .">
  
  
  
  <link rel="prev" href="https://jfy0o0.github.io/2021/other-%E5%85%AC%E7%A7%81%E9%92%A5%E5%8A%A0%E9%AA%8C%E7%AD%BEca/" />
  <link rel="next" href="https://jfy0o0.github.io/2021/linux-%E8%BD%AF%E4%BB%B6-tcpdumptcpreplay/" />
  <link rel="canonical" href="https://jfy0o0.github.io/2021/other-docker/" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <title>
       
       
           Other - docker | Jiang . &#39;s blog
       
  </title>
  <meta name="title" content="Other - docker | Jiang . &#39;s blog">
    
  
  <link rel="stylesheet" href="/font/iconfont.css">
  <link rel="stylesheet" href="/css/main.min.css">


  
  
 

<script type="application/ld+json">
 "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "https:\/\/jfy0o0.github.io"
    },
    "articleSection" : "posts",
    "name" : "Other - docker",
    "headline" : "Other - docker",
    "description" : "Docker 架构 Docker 包括三个基本概念:\n 镜像（Image）：Docker 镜像（Image），就相当于是一个 root 文件系统。比如官方镜像 ubuntu:16.04 就包含了完整的一套 Ubuntu16.04 最小系统的 root 文件系统。 容器（Container）：镜像（Image）和容器（Container）的关系，就像是面向对象程序设计中的类和实例一样，镜像是静态的定义，容器是镜像运行时的实体。容器可以被创建、启动、停止、删除、暂停等。 仓库（Repository）：仓库可看成一个代码控制中心，用来保存镜像。   Hello World $ docker run ubuntu:15.10 \/bin\/echo \u0026#34;Hello world\u0026#34; Hello world 各个参数解析：\n docker: Docker 的二进制执行文件。 run: 与前面的 docker 组合来运行一个容器。 ubuntu:15.10 指定要运行的镜像，Docker 首先从本地主机上查找镜像是否存在，如果不存在，Docker 就会从镜像仓库 Docker Hub 下载公共镜像。 \/bin\/echo \u0026ldquo;Hello world\u0026rdquo;: 在启动的容器里执行的命令  运行交互式的容器 我们通过 docker 的两个参数 -i -t，让 docker 运行的容器实现**\u0026ldquo;对话\u0026rdquo;**的能力：\n$ docker run -i -t ubuntu:15.10 \/bin\/bash root@0123ce188bd8:\/# 各个参数解析：\n -t: 在新容器内指定一个伪终端或终端。 -i: 允许你对容器内的标准输入 (STDIN) 进行交互。  启动容器（后台模式） 使用以下命令创建一个以进程方式运行的容器",
    "inLanguage" : "en-us",
    "author" : "Jiang",
    "creator" : "Jiang",
    "publisher": "Jiang",
    "accountablePerson" : "Jiang",
    "copyrightHolder" : "Jiang",
    "copyrightYear" : "2021",
    "datePublished": "2021-04-21 15:37:06 \u002b0800 CST",
    "dateModified" : "2021-04-21 15:37:06 \u002b0800 CST",
    "url" : "https:\/\/jfy0o0.github.io\/2021\/other-docker\/",
    "wordCount" : "342",
    "keywords" : [ "Other", "Jiang . \u0027s blog"]
}
</script>

</head>

  


  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    <div class="container">
        <div class="navbar-header header-logo">
        	<a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://jfy0o0.github.io">Jiang . &#39;s blog</a>
        </div>
        <div class="menu navbar-right">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
     <div class="container">
        <div class="navbar-header">
            <div>  <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://jfy0o0.github.io">Jiang . &#39;s blog</a></div>
            <div class="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
    	 <main class="main">
          <div class="container">
      		
<article class="post-warp" itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">Other - docker</h1>
        <div class="post-meta">
                Written by <a itemprop="name" href="https://jfy0o0.github.io" rel="author">Jiang</a> with ♥ 
                <span class="post-time">
                on <time datetime=2021-04-21 itemprop="datePublished">April 21, 2021</time>
                </span>
                in
                <i class="iconfont icon-folder"></i>
                <span class="post-category">
                        <a href="https://jfy0o0.github.io/categories/other/"> Other </a>
                        
                </span>
        </div>
    </header>
    <div class="post-content">
        

        

        
        
     
          
          
          

          
          
          

          <h1 id="docker">Docker</h1>
<h1 id="架构">架构</h1>
<p>Docker 包括三个基本概念:</p>
<ul>
<li><strong>镜像（Image）</strong>：Docker 镜像（Image），就相当于是一个 root 文件系统。比如官方镜像 ubuntu:16.04 就包含了完整的一套 Ubuntu16.04 最小系统的 root 文件系统。</li>
<li><strong>容器（Container）</strong>：镜像（Image）和容器（Container）的关系，就像是面向对象程序设计中的类和实例一样，镜像是静态的定义，容器是镜像运行时的实体。容器可以被创建、启动、停止、删除、暂停等。</li>
<li><strong>仓库（Repository）</strong>：仓库可看成一个代码控制中心，用来保存镜像。</li>
<li></li>
</ul>
<h1 id="hello-world">Hello World</h1>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ docker run ubuntu:15.10 /bin/echo <span style="color:#e6db74">&#34;Hello world&#34;</span>
Hello world
</code></pre></div><p>各个参数解析：</p>
<ul>
<li><strong>docker:</strong> Docker 的二进制执行文件。</li>
<li><strong>run:</strong> 与前面的 docker 组合来运行一个容器。</li>
<li><strong>ubuntu:15.10</strong> 指定要运行的镜像，Docker 首先从本地主机上查找镜像是否存在，如果不存在，Docker 就会从镜像仓库 Docker Hub 下载公共镜像。</li>
<li><strong>/bin/echo &ldquo;Hello world&rdquo;:</strong> 在启动的容器里执行的命令</li>
</ul>
<h2 id="运行交互式的容器">运行交互式的容器</h2>
<p>我们通过 docker 的两个参数 -i -t，让 docker 运行的容器实现**&ldquo;对话&rdquo;**的能力：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ docker run -i -t ubuntu:15.10 /bin/bash
root@0123ce188bd8:/#
</code></pre></div><p>各个参数解析：</p>
<ul>
<li><strong>-t:</strong> 在新容器内指定一个伪终端或终端。</li>
<li><strong>-i:</strong> 允许你对容器内的标准输入 (STDIN) 进行交互。</li>
</ul>
<h2 id="启动容器后台模式">启动容器（后台模式）</h2>
<p>使用以下命令创建一个以进程方式运行的容器</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ docker run -d ubuntu:15.10 /bin/sh -c <span style="color:#e6db74">&#34;while true; do echo hello world; sleep 1; done&#34;</span>
2b1b7a428627c51ab8810d541d759f072b4fc75487eed05812646b8534a2fe63
</code></pre></div><h1 id="镜像">镜像</h1>
<ul>
<li>查看本地镜像	docker images</li>
<li>查找镜像 docker search</li>
<li>拉取镜像 docker pull</li>
<li>删除镜像 docker rmi -f</li>
<li>上传镜像 docker push　　　　</li>
<li>使用镜像创建容器并启动 docker run
<ul>
<li>[-i]	以交互式运行</li>
<li>[-t]    为容器重新分配一个伪输入终端</li>
<li>[&ndash;name ] #创建一个名称centos_aways的容器，自动重启</li>
<li>[&ndash;restart]：always始终重启；on-failure退出状态非0时重启；默认为，no不重启</li>
<li>[-p] : &lt;host_port:contain_port&gt; #：映射 HOST 端口到容器，方便外部访问容器内服务，host_port 可以省略，省略表示把 container_port 映射到一个动态端口。</li>
<li>-d      :       表示使用守护进程运行，即服务挂在后台</li>
<li>-P    :随机的端口映射</li>
<li><code>-v</code>：表示需要将本地哪个目录挂载到容器中，格式：-v &lt;宿主机目录&gt;:&lt;容器目录&gt;</li>
</ul>
</li>
</ul>
<p>docker run -i -t sauloal/ubuntu14.04 /bin/bash  # 创建一个容器，让其中运行 bash 应用，退出后容器关闭</p>
<ul>
<li>
<p>使用镜像创建容器</p>
<p>docker create</p>
<p>-t, &ndash;tty                       Allocate a pseudo-TTY</p>
<p>-i, &ndash;interactive               Keep STDIN open even if not attached</p>
<p>-d, &ndash;detach                    Run container in background and print container ID #run的参数</p>
</li>
<li>
<p>容器资源限制参数</p>
</li>
<li>
<p>-m 1024m &ndash;memory-swap=1024m  # 限制内存最大使用（bug：超过后进程被杀死）</p>
</li>
<li>
<p>&ndash;cpuset-cpus=&ldquo;0,1&rdquo;           # 限制容器使用CPU</p>
</li>
<li>
<p>exp:运行一个mysql容器</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">sudo docker run --name first-mysql -p 3306:3306 -e MYSQL<span style="color:#ae81ff">\_</span>ROOT<span style="color:#ae81ff">\_</span>PASSWORD<span style="color:#f92672">=</span><span style="color:#ae81ff">123456</span> -d mysql
</code></pre></div></li>
<li>
<p>run            运行一个容器</p>
</li>
<li>
<p>&ndash;name         后面是这个镜像的名称</p>
</li>
<li>
<p>-p 3306:3306   表示在这个容器中使用3306端口(第二个)映射到本机的端口号也为3306(第一个)</p>
</li>
<li>
<p>-d             表示使用守护进程运行，即服务挂在后台</p>
</li>
</ul>
<h1 id="容器">容器</h1>
<ul>
<li>
<p>查看容器</p>
<ul>
<li>docker ps
<ul>
<li>-l：列出最近一次启动的container</li>
<li>-a ：列出所有的container（包含历史，即运行过的container）</li>
<li>-q ：列出最近一次运行的container ID</li>
<li>-n：上几次运行的container</li>
</ul>
</li>
</ul>
</li>
<li>
<p>启动容器</p>
<ul>
<li>
<p>docker start 容器名称</p>
</li>
<li>
<p>docker start 容器id</p>
</li>
</ul>
</li>
<li>
<p>重启容器</p>
<ul>
<li>docker restart</li>
</ul>
</li>
<li>
<p>停止容器</p>
<ul>
<li>
<p>docker stop 容器名称</p>
</li>
<li>
<p>docker stop 容器id</p>
</li>
<li>
<p>docker kill 容器名称</p>
</li>
<li>
<p>docker kill 容器id</p>
</li>
</ul>
</li>
<li>
<p>退出容器</p>
<ul>
<li>
<p>docker exit 	容器停止退出到宿主机</p>
</li>
<li>
<p>ctrl+p+q    容器不停止退出到宿主机</p>
</li>
</ul>
</li>
<li>
<p>链接容器</p>
<ul>
<li>
<p>docker attach 容器id ：重新进入到容器</p>
</li>
<li>
<p>docker exec -it 容器id /bash/shell :可以执行后直接得到结果，而不用进入到容器</p>
</li>
</ul>
</li>
<li>
<p>查看容器中的信息</p>
<ul>
<li>docker top 容器id</li>
</ul>
</li>
<li>
<p>容器日志</p>
<ul>
<li>docker logs -f[最新] -t[时间戳] &ndash;tail[显示最多多少条] 容器id</li>
</ul>
</li>
<li>
<p>容器与主机之间的数据拷贝</p>
<ul>
<li>docker cp 容器id：容器内路径 目的主机路径</li>
</ul>
</li>
<li>
<p>检查容器里文件结构的更改</p>
<ul>
<li>docker diff</li>
</ul>
</li>
<li>
<p>删除容器</p>
<ul>
<li>
<p>docker rm &lt;container&hellip;&gt; #：删除一个或多个container</p>
</li>
<li>
<p>docker rm <code>docker ps -a -q</code> #：删除所有的container</p>
</li>
<li>
<p>docker ps -a -q | xargs docker rm #：同上, 删除所有的container</p>
</li>
</ul>
</li>
</ul>
<h1 id="通用">通用</h1>
<pre><code>docker inspect 容器id/镜像 ：获取详细信息
</code></pre><h1 id="镜像制作"><strong>镜像制作</strong></h1>
<h2 id="手动修改镜创建镜像"><strong>手动修改镜创建镜像</strong></h2>
<p>docker commit 镜像ＩＤ　新镜像名称：新镜像标签</p>
<h2 id="docker脚本创建镜像"><strong>docker脚本创建镜像</strong></h2>
<p>docker build -t  镜像:标签　dcocker脚本路径</p>
<p>Dockerfile</p>
<p>Dockerfile语法格式</p>
<ul>
<li>– FROM:基础镜像　　　//docker image 查看填写要做用的样版镜像</li>
<li>– MAINTAINER:镜像创建者信息　　　//可选项</li>
<li>– EXPOSE:开放的端口　　　//要打开哪个端口</li>
<li>– ENV:设置变量　　　　　//像systemctl的，可查看/usr/lib/systemd/system下*.service文件项</li>
<li>– ADD:复制文件到镜像并解压　　//必须存放在和Dockerfile文件同一目录下</li>
<li>– COPY:复制文件到镜像</li>
<li>– RUN:制作镜像时执行的命令,可以有多个　</li>
<li>– WORKDIR:定义容器默认工作目录　　//相当于cd到哪个目录下</li>
<li>– CMD:容器启动时执行的命令,仅可以有一条CMD</li>
<li>– ENTRYPONT:　　容器启动时执行的命令，可以有多个</li>
<li>– ONBUILD:被继承时，ONBUILD可以被触发</li>
</ul>

    </div>

    <div class="post-copyright">
             
            <p class="copyright-item">
                <span>Author:</span>
                <span>Jiang . </span>
                </p>
            
           
             
            <p class="copyright-item">
                    <span>Link:</span>
                    <a href=https://jfy0o0.github.io/2021/other-docker/>https://jfy0o0.github.io/2021/other-docker/</span>
            </p>
            
             
            <p class="copyright-item lincese">
                本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可
            </p>
            
    </div>

  
    <div class="post-tags">
        
            <section>
            <i class="iconfont icon-tag"></i>Tag(s): 
            
            <span class="tag"><a href="https://jfy0o0.github.io/tags/other/">
                    #Other</a></span>
            
            </section>
        
        <section>
                <a href="javascript:window.history.back();">back</a></span> · 
                <span><a href="https://jfy0o0.github.io">home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
        <a href="https://jfy0o0.github.io/2021/other-%E5%85%AC%E7%A7%81%E9%92%A5%E5%8A%A0%E9%AA%8C%E7%AD%BEca/" class="prev" rel="prev" title="Other - 公私钥、加验签、CA"><i class="iconfont icon-left"></i>&nbsp;Other - 公私钥、加验签、CA</a>
         
        
        <a href="https://jfy0o0.github.io/2021/linux-%E8%BD%AF%E4%BB%B6-tcpdumptcpreplay/" class="next" rel="next" title="Linux Soft - tcpdump、tcpreplay">Linux Soft - tcpdump、tcpreplay&nbsp;<i class="iconfont icon-right"></i></a>
        
    </div>

    <div class="post-comment">
          
                 
          
    </div>
</article>
          </div>
		   </main>
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2011 - 2021</span>
        
        <span class="with-love">
    	 <i class="iconfont icon-love"></i> 
         </span>
         
            <span class="author" itemprop="copyrightHolder"><a href="https://jfy0o0.github.io">Jiang .</a> | </span> 
         

         
		  <span>Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow">Hugo</a> & <a href="https://github.com/liuzc/leaveit" target="_blank" rel="external nofollow">LeaveIt</a></span> 
    </div>
</footer>












    
    
    <script src="/js/vendor_no_gallery.min.js" async=""></script>
    
  



     </div>
  </body>
</html>
